---
layout: docs-ja
title: 機能と特徴
category: Manual
permalink: /manuals/1.0/ja/feature-list.html
---
# 機能と特徴

[イントロダクション](/manuals/1.0/ja/index.html)で述べたフレームワークの特徴と機能の詳細を説明します。

### 依存性の注入 (DI)

 * オブジェクトの生成や依存解決をフレームワークが自動で行い、コードの結合度を下げ、テスト性や保守性を高めます。
 * Google社製のDIフレームワークであるGuiceの設計思想を取り入れ、ほぼ全ての機能をカバーしています。
 * コンテキストに応じた束縛で、アプリケーションの振る舞いを変更できます。
 * DIのコンパイルを行いインスタンス生成のPHPコードを生成することで、実行時のオーバーヘッドを最小限に抑えます。
 * オブジェクトの依存関係はグラフで可視化できます。
 * インスタンスをルールに基づいて生成します。コンパイル（設定）時でさえユーザーはコンテナに直接アクセスすることはありません。

### アスペクト指向プログラミング (AOP)

* ビジネスロジックなど本質的関心とログやキャッシュや横断的関心を分離し、柔軟なアプリケーションを実現します。
* PHPのアトリビュートをクラスやメソッドに付与して、横断的処理を宣言的に束縛します。
* クラスやメソッド名など探索条件に適合したクラスやメソッドに横断的処理を束縛できます。

### リソース指向のアーキテクチャ (ROA)

* 全てのデータや機能をリソースとして扱い、統一的なインターフェースで操作します。
* HTTPメソッドを使ってリソースを操作し、RESTfulなAPIを実現します。
* 関連リソースの埋め込みやハイパーリンクで、リソースのツリー構造や関係性を表現します。
* HAL（Hypertext Application Language）を採用し、リソース間のリンクを標準化します。

### テストの容易性

* 各リソースは独立していて、RESTのステートレスリクエストの性質によりテストは容易です。
* リソースの状態と表現を分離し、リソースの状態を変更せずに表現のみをテスト可能です。
* ハイパーメディアのリンクをたどりながらAPIのテストを行え、PHPとHTTPの同一コードでテストできます。

### リソースの検証

JsonSchemaを使用してリソースの表現を検証し、リソースの整合性を保ちます。バリデーションに標準のスキーマを使うことで外部ツールの利用ができます。

### ストリーム出力
* リソースの表現をストリーム出力することで、メモリ上では扱えない大規模なコンテンツを出力できます。
* ストリームは通常の値のアサインと混在することができます。

### 視覚化とデバッグ

* 開発時にHTML上でリソースの範囲やツールをグラフィカルに表示します。
* Web画面でリソースの状態を確認でき、PHPコードやHTMLテンプレートをオンラインで編集し、リアルタイムに反映できます。

### 起動の高速化

* 事前コンパイルにより依存生成のPHPコードを生成して最小限のブートストラップを実現します。
* 理想的なDIの世界では起動の時に1度だけインスタンスを生成します。これをルートオブジェクトと呼びますがこのルートオブジェクトをキャッシュすることで、初期化を再利用しアプリケーションの起動を高速化します。

### PHPインターフェイスとSQL実行を束縛

* PHPインターフェイスとSQLを用意して、クラスを実装することなしにPHPのインターフェイスにSQLの実行オブジェクトを束縛することができます。
* PHPのインターフェイスにはスカラー値だけでなくオブジェクトを指定して文字列として評価することもできます。例えばDateTimeInterfaceを指定すると、SQLの日付として評価されます。
* PHPインターフェイスには引数を依存性として注入することができます。

### ドキュメント生成

コードからAPIドキュメントを自動生成します。コードとドキュメントの整合性を保ち、保守性を高めます。

### 他システムとの統合

* コンソールアプリケーションと統合し、ソースコードを変えずにWebとコマンドライン双方からアクセス可能にします
* 同一PHPランタイム内で異なるアプリケーションを並行実行でき、HTTPクライアントから全リソースにアクセス可能にします。
* ローカル及びリモートのBEAR.Sundayアプリケーションを同様に扱え、BEAR.Thriftでは他言語のアプリケーションとも連携できます。

### 標準への準拠

* デフォルトでJSON形式とwwwフォーム形式をサポートし、コンテントタイプに応じてリソースリクエストを解釈します。
* セマンティックバージョンニングを採用し、後方互換性を維持します。
* エラーはデフォルトでは`vnd.error+json`メディアタイプ形式で返却され、エラーの詳細を含めたエラーメッセージを返します。
* リソースの状態変更時にETagを使用して、キャッシュを無効化します。
* キャッシュするとHTTPヘッダーに`Cache-Control`に加え`Ages`、`Last-Modified`。`ETag`などのHTTPヘッダーが付与されます

### コード品質

* フレームワークのコードは静的解析ツールのpsalmとphpstan双方でレベル最大で適用しています。
* テストカバレッジ100%を保っています。
* アプリケーションに対しても、フレームワーク内部でもグローバルな定数を使用しません。
* グローバルなスタティックコールがありません。
* 原則的にイミュータブルなシステムであり、テストでも毎回初期化が不要なほどクリーンです。SwooleのようなPHPの非同期通信エンジンの力を引き出します。

### MVCとの相違点

* MVCのコントローラーは複数の責任を持ちがちですが、BEAR.Sundayのリソースは単一責任の原則（SRP）に従い、責任が分散されています。
* MVCのコントローラーはしばしば複雑な引数を取りますが、BEAR.Sundayではリクエストの引数が宣言的に示され、リソースのインターフェースが明確になります。
* MVCのコントローラーは様々な操作を行いますが、BEAR.Sundayのリソースはセマンティックなメソッド（意味的に明確なメソッド）を持ち、操作が明確になります。
* BEAR.Sundayでは埋め込みリソースを使い、コンテンツの依存関係が宣言的に示されます。これによりリソース間の関係性が明示的になります。
* MVCではモデルがデータと表現の両方を担当することがありますが、BEAR.Sundayではリソース自身が表現の責任を持ち、自己完結性が高まります。
* BEAR.Sundayのリソースはリレーションを宣言することで、可能な操作（アフォーダンス）を提供します。クライアントはこれを手がかりにリソースを動的に操作できます。
* MVCのビューは通常、単一の表現形式を返しますが、BEAR.Sundayではコンテンツネゴシエーションによって表現形式が動的に決定され、柔軟性が高まります。
* MVCは層を分けることでコンポーネント化を図りますが、BEAR.Sundayはリソースを中心としたコンポーネント化を図ります。
* MVCではドメインロジックがモデルに集中しがちですが、BEAR.Sundayではドメインロジックをリソースとサービスに分散させることを推奨します。
* MVCはアプリケーション状態をサーバー側で管理しがちですが、BEAR.Sundayはステートレスなリソース設計を推奨し、状態はクライアント側で管理します。
* MVCのモデルは通常、データのみを返しますが、BEAR.Sundayのリソースはレスポンスにメタ情報（有効期限やキャッシュ制御などの情報）を含めることができ、より柔軟で表現力豊かなレスポンスが可能になります。


