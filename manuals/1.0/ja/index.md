---
layout: docs-ja
title: イントロダクション
category: Manual
permalink: /manuals/1.0/ja/
---

# BEAR.Sundayとは

BEAR.SundayとはPHPのリソース指向のWebアプリケーションフレームワークです。
BEAR.Sundayの目標は、高品質でAPI中心のWebアプリケーションのフレームワークを提供することです。

## フレームワーク

BEAR.Sundayは3つのフレームワークで構成されています。

`Ray.Di`は[依存関係逆転の原則](http://en.wikipedia.org/wiki/Dependency_inversion_principle)に基づいてオブジェクトの依存をインターフェイスで結びます。

`Ray.Aop`は[アスペクト指向プログラミング](http://en.wikipedia.org/wiki/Aspect-oriented_programming)で本質的関心と横断的関心を結びます。

`BEAR.Resource`はアプリケーションの情報や機能をリソースにして[REST制約](https://en.wikipedia.org/wiki/Representational_state_transfer)で結びます。

フレームワークは、アプリケーション全体に適用される制約と設計原則です。一貫性のある設計と実装を促進し、高品質でクリーンなアプリケーションの構築の力になります。

## ライブラリ

BEAR.Sundayは、フルスタックフレームワークとは異なり、認証やデータベースなどの特定のタスクのための独自のライブラリを持ちません。その代わりに、高品質なサードパーティ製のライブラリを使用します。

この設計思想は、フレームワークは変わらないが、ライブラリは変わるという考え方と、ライブラリの選択はユーザーの権利と責任であるという考え方に基づいています。BEAR.Sundayは、フレームワークとライブラリの違いを明確に区別し、アプリケーション制約としてのフレームワークの役割を重視しています。

## リソース指向パターン

BEAR.Sundayは、従来のMVC（Model-View-Controller）パターンとは異なり、リソース指向パターンを採用しています。このパターンでは、アプリケーションの設計において、データとビジネスロジックを統一されたリソースとして扱い、それらに対するリンクと操作を中心に設計を行います。リソース指向パターンはRESTful APIの設計で広く使用されていますが、BEAR.SundayはそれをWebアプリケーション全体の設計にも適用しています。リソース指向パターンの主な特徴は次のとおりです。

- **リソースの特定**：アプリケーションで扱うデータやビジネスロジックをリソースとして特定し、統一された識別子(URI)で表現します（例：/user、/orderなど）。

- **リソースの操作**：リソースに対する操作を HTTPメソッド（GET、POST、PUT、DELETE など）にマッピングし、直感的で一貫性のある操作を可能にします。
- **ステートレス性**：リソース指向パターンでは、サーバーはクライアントの状態を保持せず、各リクエストに必要な情報をすべて含めます。これにより、スケーラビリティと信頼性が向上します。

### リソース指向パターンの利点

リソース指向パターンに採用で、WebアプリケーションがRESTfulである事の利点をアプリケーション内部設計でも享受します。

- **メンテナンスの容易さ**: 各リソースの独立性により、特定のリソースや機能に対する変更が他の部分に影響を与えにくくなり、メンテナンスが容易になります。

- **開発速度の向上**:
  RESTの設計原則に従っているため、開発者は一貫性のあるルールセットに従って効率的に作業でき、チーム内でのコラボレーションが向上します。

- **アプリケーションの拡張性**: リソース指向パターンは、アプリケーションの成長に合わせて後方互換性を確保しながら新しいリソースを追加したり、既存のリソースを更新したりする柔軟性を提供します。

- **キャッシング**
  リソース指向パターンは、Web分散システムのキャッシングを実現し、パフォーマンスとスケーラビリティを向上させます。詳しくは後述します。

- **URI**
  Webの成功の要因の1つは全ての情報にID(URI)を持った事です。これをアプリケーションにも適用し、コンテンツのツリー構造やリソースのリンクを宣言する事ができます。

- **接続性**:
  URIとステートレスなリクエストで、他のアプリケーションやデバイスからのアクセスが容易になります。詳しくは後述します。

## 長期的な視点

BEAR.Sunday は、アプリケーションの長期的な維持を念頭に置いて設計されています。

- **制約**: DI、AOP、RESTの制約に従った一貫したアプリケーション制約は、時間の経過とともに変わることがありません。

- **永遠の1.x**: 2015年の1.0リリース以来、後方互換性の破壊を伴う変更はありません。定期的な互換性対応の改修とそのテストが必要という負債がありません。アプリケーションは常に最新バージョンにアップグレードでき、互換性のための改修やテストの負債はありません。

- **クリーンな設計**: コンポーネントとの密結合を避け、DIとAOPによる疎結合を実現します。これにより、ライブラリや他のコンポーネントとの統合が容易になります。限定された依存を持つクラスはテストも容易です。

- **クリーンなランタイム**: BEAR.Sundayアプリケーションは、同一のPHPランタイム内で異なるアプリケーションと並行して実行できるほどクリーンです。

- **標準準拠**：HTTP標準、JsonSchema などの標準に従い、DIはGoogle Guice、AOPはJavaのAop Allianceに基づいています。

## 接続性

BEAR.Sundayは、Webアプリケーションを超えて、さまざまなクライアントとのシームレスな統合を可能にします。

- **HTTPクライアント**:
  HTTPクライアントを使用して全てのリソースにアクセスすることが可能です。MVCのモデルやコントローラーと違い、BEAR.Sundayのリソースはクライアントから直接のアクセスが可能です。

- **composerパッケージ**:
  composerでvednor下にインストールしたアプリケーションのリソースを直接呼び出す事ができます。マイクロサービスを使うことになしに複数のアプリケーションを協調する事ができます。

- **多言語フレームワーク**:
  BEAR.Thriftを使用して、PHP以外の言語や異なるバージョンのPHPとの連携を可能にします。

## キャッシング

リソース指向パターンは、Web本来の分散キャシングを可能にします。

- **分散キャッシュ**: キャッシュをクライアント、CDN、サーバーサイドに保存することで、CPU コストとネットワークコストの双方を削減します。

- **同一性確認**:
  ETagを使用してキャッシュされたコンテンツの同一性を確認し、コンテンツの変更があった場合にのみ再取得することで、ネットワーク効率を向上させます。

- **堅牢性**:
  イベントドリブンコンテンツの採用により、CDNを中心としたTTLをキャッシュシステムは、PHP やDBがダウンした場合でもコンテンツを提供し続けます。

- **スケール**:
  CDNを中心としたシステムではスケールも容易です。

## パフォーマンス

BEAR.Sunday は、パフォーマンスと効率性に重点を置いて設計されています。

- **インジェクションとコンパイル**: 依存関係の注入をコンパイル時に行うことで、実行時のオーバーヘッドを最小限に抑え、アプリケーションの起動と実行を高速化します。

- **キャッシング**:
  リソース指向アーキテクチャにより、CDNを中心としたキャッシングが可能になり、PHP の実行やデータベースアクセスを最小限に抑えます。

- **高速起動**:
  フレームワークの機能をルートオブジェクトとしてコンパイルすることで、最小限のブートストラップを実現し、Swooleなどのランタイムを使用した超高速なレスポンスを可能にします。

## Because Everything is a Resource

「全てがリソース」のBEAR.Sundayは、Webの本質であるリソースを中心に設計されたPHPのWebアプリケーションフレームワークです。その真の価値は、オブジェクト指向原則とREST原則に基づいた優れた制約をアプリケーション全体の制約として提供することにあります。

この制約は、開発者に一貫性のある設計と実装を促し、長期的な視点に立ったアプリケーションの品質を高めます。同時に、この制約は開発者に自由をもたらし、アプリケーション構築の創造性を高めます。

## 特徴一覧

- **依存性の注入 (DI)** - ブジェクトの生成や依存解決をフレームワークが行うことで、コードの結合度を下げ、テスト性や保守性を高めます。
  - **Google Guiceに基づくDI** - Google社製のDIフレームワークであるGuiceの設計思想を取り入れ、ほとんどの機能をカバーしています。
  - **コンテキスト別束縛** - **同じインターフェースに対して、コンテキストに応じた束縛を行いアプリケーションの振る舞いを変更させる事ができます。
  - **DIコンパイラ** - DIのコンパイルを行いインスタンスを生成するPHPコードを生成し、実行時のオーバーヘッドを最小限に抑えます。
  - **依存グラフ描画** - **依存関係をグラフで描画し、アプリケーションの構造を可視化します。
- **アスペクト指向プログラミング (AOP)**
  - **PHPアトリビュートによる宣言的な設定**  PHP8で導入されたアトリビュート機能を活用し、アノテーションベースの設定を行います。
  - **探索による横断処理束縛** - インターセプターを探索条件に適合したクラスやメソッドに束縛して、柔軟なAOPを実現します。
- **リソース指向のアーキテクチャ (ROA)** - すべてのデータや機能をリソースとして扱い、統一的なインターフェースで操作することで、疎結合でスケーラブルなシステムを構築します。
  - **HTTPメソッドによる操作** - GET, POST, PUT, DELETEなどのHTTPメソッドを使ってリソースを操作し、RESTfulなAPIを実現します。
  - **埋め込みリソース** - 関連するリソースをリソースに埋め込みリソースのツリー構造を表現します。
  - **リソースのリンク** -リソース間の関係をハイパーリンクで表現し、APIの可視性とたどり着きやすさを高めます。
  - **HALメディアタイプ** - リソースの表現形式としてHAL（Hypertext Application Language）を採用し、リソース間のリンクを標準化し埋め込みリソースを表現します。
  - **テストの容易性** - リソースの状態と表現を分離することで、リソースの状態を変更することなくリソースの表現をテストできます。
  - **ハイパーメディアHTTPテスト** - ハイパーメディアのリンクをたどりながらAPIのテストを行うことで、APIの振る舞いをテストします。
  - **リソース状態とリソースの表現の分離** - リソースの状態と表現形式を分離することで、柔軟性と拡張性を確保します。
  - **視覚化とデバック** - HTML上でリソースの範囲やツールをグラフィカルに表示し、Web画面でリソースの状態を知る事ができます。
  - **オンライン編集** - PHPコードやHTMLテンプレートをオンラインで編集し、リアルタイムに変更を反映します。
- **分散キャッシュ** - リソース指向アーキテクチャにより、Webの分散キャッシングを実現し、パフォーマンスとスケーラビリティを向上させます。
  - **イベントドリブンコンテンツ** - リソースの状態変更時にキャッシュを無効化して、CDNを中心としたキャッシングを実現します。
  - **ETagによる同一性確認** - ETagを使用してキャッシュされたコンテンツの同一性を確認し、ネットワーク効率を向上させます。
  - **依存解決によるキャッシュ無効化** - リソース間の依存関係を解析し、関連するキャッシュを自動的に無効化します。
- **ブートストラップ**
  - **ユーザーサイドスクリプト** - アプリケーションはユーザーサイドのスクリプトで開始、終了する事で、アプリケーションのライフサイクルを制御します。
  - **ルートオブジェクトキャッシュ** - ルートオブジェクトをコンパイルしてキャッシュし、アプリケーションの起動を高速化します。
  - **事前コンパイルによる最小の初期化** - フレームワークの機能をルートオブジェクトとしてコンパイルすることで、最小限のブートストラップを実現します。
- **コンパイルタイムとランタイムの明確な区別** - 可能な限り起動前の処理をコンパイルとして事前に行い、ランタイムの処理を最小化することでオーバーヘッドを最小限に抑えます。
- **PHPインターフェイスとSQL実行の束縛** - PHPインターフェイスとSQLの実行オブジェクトを束縛し、インフラストラクチャの変更を容易にします。
- **コードからAPIドキュメントを生成** - コードからAPIドキュメントを自動生成し、ドキュメントの保守性を高めコードとドキュメントの整合性を保ちます。
- **コンソールアプリケーションとの統合** - ソースコードを変えることなしに、Webとコマンドライン双方からアクセスが可能です。
- **同一PHPランタイムでの複数アプリケーション実行** - 同一のPHPランタイム内で異なるアプリケーションを並行して実行できます。
- **接続** - HTTPクライアントを使用して全てのリソースにアクセスすることが可能です。MVCのモデルやコントローラーと違い、BEAR.Sundayのリソースはクライアントから直接のアクセスが可能です。
  - **ローカル及びリモートのBEAR.Sundayアプリケーション** - ローカル及びリモートのBEAR.Sundayアプリケーションを同じように扱うことができます。
  - **多言語** - BEAR.Thriftを使用して、PHP以外の言語や異なるバージョンのPHPとの連携を可能にします。
- **Swoole対応** - 高性能なPHPの非同期通信エンジンであるSwooleを使用して、高速なWebサーバーを実現します。
- **ストリーム出力** - リソースの表現をストリーム出力することで、オンメモリでは出力できない巨大なコンテンツを出力できます。
- **静的解析レベル最大、カバレッジ100%のクリーンなコード** - 静的解析ツールを使用して、コードの品質を維持し、カバレッジ100%を維持しています。
